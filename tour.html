<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VIET NAM TO YOU TOURISM COMPANY LIMITED - Tours</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="popup/popup.css">
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
        <div class="container">
            <a class="navbar-brand" href="index.html"><img src="images/VN TO YOU LOGO.png" alt="VIET NAM TO YOU TOURISM COMPANY LIMITED" class="img-fluid"></a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item"><a class="nav-link" href="index.html">Introduction</a></li>
                    <li class="nav-item"><a class="nav-link active" href="tour.html">Tours</a></li>
                    <li class="nav-item"><a class="nav-link" href="contact.html">Contact</a></li>
                    <li class="nav-item"><a class="nav-link" href="news.html">News</a></li>
                </ul>
            </div>
        </div>
    </nav>

    <header class="bg-primary text-white text-center py-5">
        <div class="container">
            <h1>Travel Tours</h1>
            <p>Explore amazing destinations with tours specially designed for businesses.</p>
        </div>
    </header>

    <section class="py-4">
        <div class="container">
            <!-- Ultra Compact Filter Section -->
            <div class="filter-section mb-3">
                <!-- Filter Label -->
                <div class="mb-2">
                    <span class="text-muted small">Filter by:</span>
                </div>

                <!-- Super Compact Filter Buttons -->
                <div class="filter-buttons">
                    <!-- All filters in 2 compact lines -->
                    <div class="filter-group mb-1">
                        <button class="btn btn-sm btn-outline-primary filter-btn active" data-filter="region" data-value="all">All</button>
                        <button class="btn btn-sm btn-outline-primary filter-btn" data-filter="region" data-value="bac">North</button>
                        <button class="btn btn-sm btn-outline-primary filter-btn" data-filter="region" data-value="trung">Central</button>
                        <button class="btn btn-sm btn-outline-primary filter-btn" data-filter="region" data-value="nam">South</button>
                    </div>
                    
                    <div class="filter-group d-flex flex-wrap gap-1">
                        <button class="btn btn-sm btn-outline-primary filter-btn active" data-filter="days" data-value="all">Any</button>
                        <button class="btn btn-sm btn-outline-primary filter-btn" data-filter="days" data-value="1-3">1-3D</button>
                        <button class="btn btn-sm btn-outline-primary filter-btn" data-filter="days" data-value="4-7">4-7D</button>
                        <button class="btn btn-sm btn-outline-primary filter-btn" data-filter="days" data-value="8+">8+D</button>
                        <span class="divider mx-1 d-none d-md-inline">|</span>
                        <div id="popular-tags" class="d-inline-flex flex-wrap gap-1">
                            <!-- Popular tags sáº½ Ä‘Æ°á»£c load Ä‘á»™ng -->
                        </div>
                    </div>
                </div>
            </div>
            <div class="row" id="tour-list">
                <!-- Tours sáº½ Ä‘Æ°á»£c load tá»± Ä‘á»™ng báº±ng JavaScript -->
            </div>
        </div>
    </section>

    <footer class="bg-dark text-white py-4">
        <div class="container">
            <div class="row">
                <div class="col-md-6">
                    <p>&copy; 2025 VIET NAM TO YOU TOURISM COMPANY LIMITED. All rights reserved.</p>
                </div>
                <div class="col-md-6">
                    <div class="contact-footer">
                        <p class="mb-2"><strong>Contact us:</strong></p>
                        <p class="mb-1">
                            <i class="fas fa-map-marker-alt me-2"></i>
                            Address: No. 5TT1 Alley 537 Bat Khoi Str, Long Bien Dist, Hanoi, Vietnam
                        </p>
                        <p class="mb-1">
                            <a href="mailto:SALES@VNTOYOU.NET" class="text-white text-decoration-none">
                                ðŸ“§ Email: SALES@VNTOYOU.NET
                            </a>
                        </p>
                        <p class="mb-1">
                            <a href="tel:+84904596505" class="text-white text-decoration-none">
                                ðŸ“± Hotline: +84 904 596 505 (Ms. Ngan)
                            </a>
                        </p>
                        <p class="mb-0">
                            <a href="https://wa.me/84904596505" class="text-white text-decoration-none" target="_blank">
                                ðŸ’¬ WhatsApp: +84 904 596 505 (Ms. Ngan)
                            </a>
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </footer>

    <!-- Back to Top Button -->
    <button class="back-to-top" onclick="scrollToTop()">
        â†‘
    </button>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="popup/popup.js"></script>
    <script>
        let allTours = []; // LÆ°u trá»¯ táº¥t cáº£ tours

        // Load tours tá»« JSON
        async function loadTours() {
            try {
                const response = await fetch('tours/data/tours.json');
                allTours = await response.json();
                displayTours(allTours);
                return allTours; // Return promise for chaining
            } catch (error) {
                console.error('Lá»—i load tours:', error);
                return [];
            }
        }

        // Current view mode
        let currentViewMode = 'grid';

        // Hiá»ƒn thá»‹ tours
        function displayTours(tours) {
            const tourList = document.getElementById('tour-list');
            tourList.innerHTML = '';

            if (currentViewMode === 'grid') {
                displayToursGrid(tours);
            } else {
                displayToursList(tours);
            }
        }

        // Grid view display
        function displayToursGrid(tours) {
            const tourList = document.getElementById('tour-list');
            tourList.className = 'row';

            tours.forEach(tour => {
                // Generate hashtags display
                const hashtagsHtml = tour.hashtags ? 
                    tour.hashtags.slice(0, 3).map(tag => 
                        `<span class="badge bg-secondary me-1">${tag}</span>`
                    ).join('') : '';

                // Region badge color
                const regionBadgeClass = {
                    'Northern Vietnam': 'bg-success',
                    'Central Vietnam': 'bg-warning text-dark', 
                    'Southern Vietnam': 'bg-info'
                }[tour.region] || 'bg-secondary';

                const tourCard = `
                    <div class="col-md-4 mb-4" data-region="${tour.region}" data-days="${tour.days}">
                        <div class="card h-100">
                            <img src="${tour.image}" class="card-img-top" alt="${tour.title}" onerror="this.src='https://via.placeholder.com/300x200'" style="height: 200px; object-fit: cover;">
                            <div class="card-body d-flex flex-column">
                                <div class="mb-2">
                                    <span class="badge ${regionBadgeClass}">${tour.region}</span>
                                    ${tour.city ? `<span class="badge bg-light text-dark ms-1">${tour.city}</span>` : ''}
                                </div>
                                <h5 class="card-title">${tour.title}</h5>
                                <p class="card-text flex-grow-1">${tour.description}</p>
                                
                                <div class="mb-2">
                                    <small class="text-muted">
                                        <i class="fas fa-calendar-alt me-1"></i>${tour.days} Days
                                        ${tour.price ? `<span class="ms-3"><i class="fas fa-tag me-1"></i>${tour.price}</span>` : ''}
                                    </small>
                                </div>
                                
                                ${hashtagsHtml ? `<div class="mb-2">${hashtagsHtml}</div>` : ''}
                                
                                <div class="mt-auto">
                                    <a href="tours/details/tour-detail.html?id=${tour.id}" class="btn btn-primary w-100">
                                        <i class="fas fa-eye me-1"></i>View Details
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
                tourList.innerHTML += tourCard;
            });
        }

        // List view display
        function displayToursList(tours) {
            const tourList = document.getElementById('tour-list');
            tourList.className = '';

            tours.forEach(tour => {
                // Generate hashtags display
                const hashtagsHtml = tour.hashtags ? 
                    tour.hashtags.slice(0, 5).map(tag => 
                        `<span class="badge bg-secondary me-1">${tag}</span>`
                    ).join('') : '';

                // Region badge color
                const regionBadgeClass = {
                    'Northern Vietnam': 'bg-success',
                    'Central Vietnam': 'bg-warning text-dark', 
                    'Southern Vietnam': 'bg-info'
                }[tour.region] || 'bg-secondary';

                const tourListItem = `
                    <div class="card mb-3 tour-list-item" data-region="${tour.region}" data-days="${tour.days}">
                        <div class="row g-0">
                            <div class="col-md-3">
                                <img src="${tour.image}" class="img-fluid rounded-start h-100" alt="${tour.title}" 
                                     onerror="this.src='https://via.placeholder.com/300x200'" style="object-fit: cover; min-height: 200px;">
                            </div>
                            <div class="col-md-9">
                                <div class="card-body h-100 d-flex flex-column">
                                    <div class="d-flex justify-content-between align-items-start mb-2">
                                        <div>
                                            <span class="badge ${regionBadgeClass}">${tour.region}</span>
                                            ${tour.city ? `<span class="badge bg-light text-dark ms-1">${tour.city}</span>` : ''}
                                        </div>
                                        <div class="text-end">
                                            <small class="text-muted">
                                                <i class="fas fa-calendar-alt me-1"></i>${tour.days} Days
                                            </small>
                                            ${tour.price ? `<div class="h6 mb-0 text-primary"><i class="fas fa-tag me-1"></i>${tour.price}</div>` : ''}
                                        </div>
                                    </div>
                                    
                                    <h5 class="card-title">${tour.title}</h5>
                                    <small class="text-muted d-block mb-2">Tour ID: ${tour.id}</small>
                                    <p class="card-text flex-grow-1">${tour.description}</p>
                                    
                                    ${hashtagsHtml ? `<div class="mb-3">${hashtagsHtml}</div>` : ''}
                                    
                                    <div class="d-flex justify-content-center">
                                        <a href="tours/details/tour-detail.html?id=${tour.id}" class="btn btn-primary">
                                            <i class="fas fa-eye me-1"></i>View Details
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
                tourList.innerHTML += tourListItem;
            });
        }

        // Toggle view mode
        function toggleViewMode(mode) {
            currentViewMode = mode;
            
            // Update radio button states
            const gridRadio = document.getElementById('grid-view');
            const listRadio = document.getElementById('list-view');
            
            if (gridRadio && listRadio) {
                gridRadio.checked = (mode === 'grid');
                listRadio.checked = (mode === 'list');
            }
            
            // Re-display tours with new mode
            const currentTours = getCurrentFilteredTours();
            displayTours(currentTours);
        }

        // Get currently filtered tours (for view switching)
        function getCurrentFilteredTours() {
            let filteredTours = allTours;
            
            // Apply filters using currentFilters
            if (currentFilters.region !== 'all') {
                const regionMap = {
                    'bac': 'Northern Vietnam',
                    'trung': 'Central Vietnam', 
                    'nam': 'Southern Vietnam'
                };
                filteredTours = filteredTours.filter(tour => 
                    tour.region === regionMap[currentFilters.region]
                );
            }

            if (currentFilters.days !== 'all') {
                filteredTours = filteredTours.filter(tour => {
                    const days = tour.days;
                    if (currentFilters.days === '1-3') return days >= 1 && days <= 3;
                    if (currentFilters.days === '4-7') return days >= 4 && days <= 7;
                    if (currentFilters.days === '8+') return days >= 8;
                    return true;
                });
            }

            if (currentFilters.hashtag !== 'all') {
                filteredTours = filteredTours.filter(tour => 
                    tour.hashtags && tour.hashtags.includes(currentFilters.hashtag)
                );
            }
            
            return filteredTours;
        }

        // Current filter states
        let currentFilters = {
            region: 'all',
            days: 'all',
            hashtag: 'all'
        };

        // Load popular tags as clickable buttons (ultra compact version)
        function loadPopularTags() {
            const popularTagsContainer = document.getElementById('popular-tags');
            const tagCount = {};
            
            // Count hashtag usage
            allTours.forEach(tour => {
                if (tour.hashtags) {
                    tour.hashtags.forEach(tag => {
                        tagCount[tag] = (tagCount[tag] || 0) + 1;
                    });
                }
            });
            
            // Sort by popularity and take top 4 for ultra compact layout
            const sortedTags = Object.entries(tagCount)
                .sort((a, b) => b[1] - a[1])
                .slice(0, 4);
            
            // Add "All Tags" button first
            popularTagsContainer.innerHTML = `
                <button class="btn btn-sm btn-outline-primary filter-btn active" data-filter="hashtag" data-value="all" title="All Tags">
                    #All
                </button>
            `;
            
            // Add popular tags (ultra compact - max 6 characters)
            sortedTags.forEach(([tag, count]) => {
                const shortTag = tag.replace('#', '').substring(0, 6); // Remove # and limit to 6 chars
                const button = document.createElement('button');
                button.className = 'btn btn-sm btn-outline-primary filter-btn';
                button.dataset.filter = 'hashtag';
                button.dataset.value = tag;
                button.title = `${tag} (${count} tours)`;
                button.innerHTML = `#${shortTag}`;
                popularTagsContainer.appendChild(button);
            });
        }

        // Handle filter button clicks
        function handleFilterButtonClick(event) {
            const button = event.target.closest('.filter-btn');
            if (!button) return;

            const filterType = button.dataset.filter;
            const filterValue = button.dataset.value;
            
            // Update current filters state
            currentFilters[filterType] = filterValue;
            
            // Update active state for buttons in the same group
            const groupButtons = document.querySelectorAll(`[data-filter="${filterType}"]`);
            groupButtons.forEach(btn => btn.classList.remove('active'));
            button.classList.add('active');
            
            // Apply filter
            filterTours();
        }

        // Filter function (no search)
        function filterTours() {
            let filteredTours = allTours;
            
            // Filter by region
            if (currentFilters.region !== 'all') {
                const regionMap = {
                    'bac': 'Northern Vietnam',
                    'trung': 'Central Vietnam', 
                    'nam': 'Southern Vietnam'
                };
                filteredTours = filteredTours.filter(tour => 
                    tour.region === regionMap[currentFilters.region]
                );
            }

            // Filter by days
            if (currentFilters.days !== 'all') {
                filteredTours = filteredTours.filter(tour => {
                    const days = tour.days;
                    if (currentFilters.days === '1-3') return days >= 1 && days <= 3;
                    if (currentFilters.days === '4-7') return days >= 4 && days <= 7;
                    if (currentFilters.days === '8+') return days >= 8;
                    return true;
                });
            }

            // Filter by hashtag
            if (currentFilters.hashtag !== 'all') {
                filteredTours = filteredTours.filter(tour => 
                    tour.hashtags && tour.hashtags.includes(currentFilters.hashtag)
                );
            }
            
            displayTours(filteredTours);
            updateResultsCount(filteredTours.length, allTours.length);
        }

        // Update results count with view toggle
        function updateResultsCount(current, total) {
            let resultInfo = document.getElementById('results-info');
            if (!resultInfo) {
                resultInfo = document.createElement('div');
                resultInfo.id = 'results-info';
                resultInfo.className = 'mb-2 d-flex justify-content-between align-items-center';
                document.getElementById('tour-list').parentNode.insertBefore(resultInfo, document.getElementById('tour-list'));
            }
            
            let countText, countIcon;
            const isMobile = window.innerWidth <= 480;
            
            if (current === total) {
                countIcon = 'fas fa-list';
                countText = isMobile ? `${total}` : `${total} tours`;
            } else {
                countIcon = 'fas fa-filter';
                countText = isMobile ? `${current}/${total}` : `${current} of ${total} tours`;
            }
            
            resultInfo.innerHTML = `
                <span class="results-count">
                    <i class="${countIcon} me-1"></i>${countText}
                </span>
                <div class="btn-group btn-group-sm" role="group">
                    <input type="radio" class="btn-check" name="viewMode" id="grid-view" autocomplete="off" ${currentViewMode === 'grid' ? 'checked' : ''}>
                    <label class="btn btn-outline-primary" for="grid-view">
                        <i class="fas fa-th"></i>
                    </label>
                    <input type="radio" class="btn-check" name="viewMode" id="list-view" autocomplete="off" ${currentViewMode === 'list' ? 'checked' : ''}>
                    <label class="btn btn-outline-primary" for="list-view">
                        <i class="fas fa-list"></i>
                    </label>
                </div>
            `;
            
            // Re-attach event listeners for radio buttons
            document.getElementById('grid-view').addEventListener('change', function() {
                if (this.checked) toggleViewMode('grid');
            });
            document.getElementById('list-view').addEventListener('change', function() {
                if (this.checked) toggleViewMode('list');
            });
        }





        // Khá»Ÿi táº¡o
        document.addEventListener('DOMContentLoaded', function() {
            loadTours().then(() => {
                loadPopularTags(); // Load popular tags as buttons
                updateResultsCount(allTours.length, allTours.length); // Initial count (will create view buttons)
            });
            
            // Filter button click events
            document.addEventListener('click', handleFilterButtonClick);
            
            // Update results count on window resize for responsive text
            let resizeTimeout;
            window.addEventListener('resize', function() {
                clearTimeout(resizeTimeout);
                resizeTimeout = setTimeout(() => {
                    const currentTours = getCurrentFilteredTours();
                    updateResultsCount(currentTours.length, allTours.length);
                }, 150);
            });
            
            // Note: View mode toggle buttons are created and attached in updateResultsCount()
        });

        // Back to Top functionality
        function scrollToTop() {
            window.scrollTo({
                top: 0,
                behavior: 'smooth'
            });
        }

        // Show/hide back to top button based on scroll position
        window.addEventListener('scroll', function() {
            const backToTopButton = document.querySelector('.back-to-top');
            if (window.pageYOffset > 300) {
                backToTopButton.classList.add('show');
            } else {
                backToTopButton.classList.remove('show');
            }
        });
    </script>
</body>
</html>